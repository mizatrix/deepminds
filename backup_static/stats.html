<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Statistics — Excellence Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background:#f7f9fc; }
    .hero { background:#0d6efd; color:#fff; border-radius:1rem; }
    .card-hover:hover { transform: translateY(-4px); transition:.2s; }
    .badge-cat { text-transform: capitalize; }
    footer a { text-decoration:none }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="index.html"><i class="bi bi-mortarboard"></i> Excellence Portal</a>
    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="activities.html">Scientific & Artistic</a></li>
<li class="nav-item"><a class="nav-link" href="training.html">Training & Internships</a></li>
<li class="nav-item"><a class="nav-link" href="competitions.html">Competitions</a></li>
<li class="nav-item"><a class="nav-link" href="awards.html">Awards & Recognition</a></li>
<li class="nav-item"><a class="nav-link" href="sports.html">Sports Achievements</a></li>
<li class="nav-item"><a class="nav-link active" href="stats.html">Statistics</a></li>
      </ul>
      
      <div class="d-flex gap-2">
        <a class="btn btn-outline-primary" href="login.html">Login</a>
        <a class="btn btn-primary" href="register.html">Register</a>
      </div>
    
    </div>
  </div>
</nav>

<header class="container my-4">
  <div class="p-4 hero"><h2 class="mb-0">Statistics</h2></div>
</header>
<main class="container my-4">
  <div class="row g-3">
    <div class="col-md-3"><div class="card"><div class="card-body">
      <div class="text-muted small">Total</div><h3 id="kpi-total">0</h3>
    </div></div></div>
    <div class="col-md-3"><div class="card"><div class="card-body">
      <div class="text-muted small">Approved</div><h3 id="kpi-approved">0</h3>
    </div></div></div>
    <div class="col-md-3"><div class="card"><div class="card-body">
      <div class="text-muted small">Pending</div><h3 id="kpi-pending">0</h3>
    </div></div></div>
    <div class="col-md-3"><div class="card"><div class="card-body">
      <div class="text-muted small">Rejected</div><h3 id="kpi-rejected">0</h3>
    </div></div></div>
  </div>

  <div class="my-4">
    <div class="card"><div class="card-body">
      <h5 class="mb-3">Achievements by Category</h5>
      <canvas id="chartCat" height="120"></canvas>
    </div></div>
  </div>

  <div class="my-4">
    <div class="card"><div class="card-body">
      <h5 class="mb-3">Top 5 Students by Points</h5>
      <canvas id="chartTop" height="120"></canvas>
    </div></div>
  </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
fetch('data.json').then(r=>r.json()).then(d=>{
  const A = d.achievements;
  const U = Object.fromEntries(d.users.map(u=>[u.id,u]));

  const total = A.length;
  const approved = A.filter(x=>x.status==='approved').length;
  const pending = A.filter(x=>x.status==='pending').length;
  const rejected = A.filter(x=>x.status==='rejected').length;
  document.getElementById('kpi-total').textContent = total;
  document.getElementById('kpi-approved').textContent = approved;
  document.getElementById('kpi-pending').textContent = pending;
  document.getElementById('kpi-rejected').textContent = rejected;

  const byCat = {};
  A.filter(x=>x.status==='approved').forEach(x=>byCat[x.category]=(byCat[x.category]||0)+1);
  new Chart(document.getElementById('chartCat'), { type: 'bar', data: { labels: Object.keys(byCat), datasets: [{ label: 'Approved', data: Object.values(byCat) }] }, options: { responsive: true, plugins: { legend: { display: true } } } });

  const points = {}
  A.filter(x=>x.status==='approved').forEach(x=>points[x.user_id]=(points[x.user_id]||0)+(x.points||0));
  const top = Object.entries(points).sort((a,b)=>b[1]-a[1]).slice(0,5);
  new Chart(document.getElementById('chartTop'), { type: 'bar', data: { labels: top.map(t=>U[t[0]]?.full_name||'Student'), datasets: [{ label: 'Points', data: top.map(t=>t[1]) }] }, options: { responsive: true } });
});
</script>

<footer class="border-top py-4 mt-5 bg-white">
  <div class="container d-flex justify-content-between flex-wrap gap-2">
    <span>© 2025 University — Academic Excellence Portal</span>
    <span class="text-muted">Demo content & sample data</span>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>